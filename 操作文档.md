# åŠ å¯†è´§å¸é‡åŒ–äº¤æ˜“ç³»ç»Ÿ - å®Œæ•´æ“ä½œæ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [ç³»ç»ŸåŠŸèƒ½](#ç³»ç»ŸåŠŸèƒ½)
3. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
4. [è¯¦ç»†åŠŸèƒ½è¯´æ˜](#è¯¦ç»†åŠŸèƒ½è¯´æ˜)
5. [å‘½ä»¤è¡Œä½¿ç”¨](#å‘½ä»¤è¡Œä½¿ç”¨)
6. [Python APIä½¿ç”¨](#python-apiä½¿ç”¨)
7. [é…ç½®æ–‡ä»¶è¯´æ˜](#é…ç½®æ–‡ä»¶è¯´æ˜)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ç³»ç»Ÿæ¦‚è¿°

**åŠ å¯†è´§å¸é‡åŒ–äº¤æ˜“ç³»ç»Ÿ v3.0** æ˜¯ä¸€ä¸ªä¸“ä¸šçš„é‡åŒ–äº¤æ˜“å›æµ‹å’Œåˆ†æå¹³å°ï¼Œæ”¯æŒï¼š

- âœ… å¤šç­–ç•¥å›æµ‹ï¼ˆEMA+RSIç­–ç•¥ã€å¤šå› å­ç­–ç•¥ï¼‰
- âœ… ç›ˆåˆ©äº¤æ˜“åˆ†æå’Œç­–ç•¥ä¼˜åŒ–
- âœ… é»‘å¤©é¹…äº‹ä»¶é˜²æŠ¤
- âœ… å› å­åˆ†æå’Œç ”ç©¶
- âœ… å‚æ•°ä¼˜åŒ–
- âœ… å®Œæ•´çš„é£é™©æŒ‡æ ‡ç»Ÿè®¡

---

## ç³»ç»ŸåŠŸèƒ½

### 1. æ•°æ®è·å–æ¨¡å— (`data/fetch_data.py`)

#### 1.1 æ ¸å¿ƒåŠŸèƒ½

**ä¸»è¦åŠŸèƒ½ï¼š**
- âœ… æ”¯æŒä»OKXç­‰äº¤æ˜“æ‰€è·å–å†å²Kçº¿æ•°æ®
- âœ… è‡ªåŠ¨æ•°æ®ç¼“å­˜ï¼ˆParquetæ ¼å¼ï¼Œæé«˜åŠ è½½é€Ÿåº¦ï¼‰
- âœ… æ”¯æŒå¤šæ—¶é—´æ¡†æ¶ï¼ˆ1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 8h, 12h, 1d, 3d, 1w, 1Mï¼‰
- âœ… æ‰¹é‡è·å–å¤§é‡å†å²æ•°æ®ï¼ˆè‡ªåŠ¨åˆ†æ‰¹ï¼Œæ”¯æŒæ•°ä¸‡æ ¹Kçº¿ï¼‰
- âœ… ä»£ç†æ”¯æŒï¼ˆHTTP/HTTPSä»£ç†ï¼‰
- âœ… æŒ‰æ—¥æœŸèŒƒå›´è·å–æ•°æ®
- âœ… å¤šæ—¶é—´æ¡†æ¶æ‰¹é‡è·å–
- âœ… è·å–å¯ç”¨äº¤æ˜“å¯¹åˆ—è¡¨

**æ ¸å¿ƒç‰¹æ€§ï¼š**
- ğŸ”„ æ™ºèƒ½ç¼“å­˜æœºåˆ¶ï¼šé¿å…é‡å¤è¯·æ±‚ï¼Œç¼“å­˜è¿‡æœŸæ—¶é—´å¯é…ç½®
- ğŸ” è‡ªåŠ¨å»é‡å’Œæ’åºï¼šç¡®ä¿æ•°æ®å®Œæ•´æ€§
- ğŸ›¡ï¸ å¼‚å¸¸å¤„ç†å’Œé‡è¯•æœºåˆ¶ï¼šç½‘ç»œé”™è¯¯è‡ªåŠ¨é‡è¯•
- ğŸ“Š è¿›åº¦æ˜¾ç¤ºï¼šå¤§æ‰¹é‡æ•°æ®è·å–æ—¶æ˜¾ç¤ºè¿›åº¦
- âš¡ è‡ªåŠ¨é™çº§ï¼šç½‘ç»œå¤±è´¥æ—¶ä½¿ç”¨è¿‡æœŸç¼“å­˜

#### 1.2 DataFetcher ç±»

**åˆå§‹åŒ–å‚æ•°ï¼š**

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `exchange_name` | str | `'okx'` | äº¤æ˜“æ‰€åç§°ï¼ˆæ”¯æŒccxtæ‰€æœ‰äº¤æ˜“æ‰€ï¼‰ |
| `proxy` | Dict | `None` | ä»£ç†é…ç½®ï¼Œæ ¼å¼ï¼š`{'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}` |
| `cache_dir` | str | `'data/cache'` | ç¼“å­˜ç›®å½•è·¯å¾„ |
| `cache_enabled` | bool | `True` | æ˜¯å¦å¯ç”¨ç¼“å­˜ |
| `cache_expiry_hours` | int | `1` | ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆå°æ—¶ï¼‰ |

**æ”¯æŒçš„æ—¶é—´æ¡†æ¶ï¼š**

```python
TIMEFRAME_MS = {
    '1m': 60 * 1000,        # 1åˆ†é’Ÿ
    '3m': 3 * 60 * 1000,     # 3åˆ†é’Ÿ
    '5m': 5 * 60 * 1000,     # 5åˆ†é’Ÿ
    '15m': 15 * 60 * 1000,   # 15åˆ†é’Ÿ
    '30m': 30 * 60 * 1000,   # 30åˆ†é’Ÿ
    '1h': 60 * 60 * 1000,    # 1å°æ—¶
    '2h': 2 * 60 * 60 * 1000, # 2å°æ—¶
    '4h': 4 * 60 * 60 * 1000, # 4å°æ—¶
    '6h': 6 * 60 * 60 * 1000, # 6å°æ—¶
    '8h': 8 * 60 * 60 * 1000, # 8å°æ—¶
    '12h': 12 * 60 * 60 * 1000, # 12å°æ—¶
    '1d': 24 * 60 * 60 * 1000,  # 1å¤©
    '3d': 3 * 24 * 60 * 60 * 1000, # 3å¤©
    '1w': 7 * 24 * 60 * 60 * 1000, # 1å‘¨
    '1M': 30 * 24 * 60 * 60 * 1000, # 1æœˆ
}
```

#### 1.3 ä¸»è¦æ–¹æ³•

##### 1.3.1 `fetch_ohlcv()` - è·å–OHLCVæ•°æ®

**åŠŸèƒ½ï¼š** è·å–æŒ‡å®šäº¤æ˜“å¯¹å’Œæ—¶é—´æ¡†æ¶çš„Kçº¿æ•°æ®

**å‚æ•°ï¼š**

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `symbol` | str | `'BTC/USDT'` | äº¤æ˜“å¯¹ï¼Œå¦‚ `'BTC/USDT'`, `'ETH/USDT'` |
| `timeframe` | str | `'1h'` | æ—¶é—´æ¡†æ¶ï¼Œå¦‚ `'30m'`, `'1h'`, `'4h'`, `'1d'` |
| `limit` | int | `1000` | è·å–Kçº¿æ•°é‡ |
| `since` | int | `None` | èµ·å§‹æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ï¼Œå¦‚æœä¸ºNoneåˆ™ä»å½“å‰å‘è¿‡å»è·å– |
| `use_cache` | bool | `True` | æ˜¯å¦ä½¿ç”¨ç¼“å­˜ |

**è¿”å›å€¼ï¼š** `pd.DataFrame`ï¼ŒåŒ…å«ä»¥ä¸‹åˆ—ï¼š
- `open`: å¼€ç›˜ä»·
- `high`: æœ€é«˜ä»·
- `low`: æœ€ä½ä»·
- `close`: æ”¶ç›˜ä»·
- `volume`: æˆäº¤é‡
- ç´¢å¼•ä¸º `Date`ï¼ˆDatetimeIndexï¼‰

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
from data.fetch_data import DataFetcher

# åˆ›å»ºæ•°æ®è·å–å™¨
fetcher = DataFetcher(
    exchange_name='okx',
    cache_enabled=True,
    cache_expiry_hours=1
)

# ç¤ºä¾‹1: è·å–æœ€è¿‘1000æ ¹1å°æ—¶Kçº¿
df = fetcher.fetch_ohlcv('BTC/USDT', '1h', 1000)

# ç¤ºä¾‹2: è·å–æœ€è¿‘20000æ ¹30åˆ†é’ŸKçº¿
df = fetcher.fetch_ohlcv('BTC/USDT', '30m', 20000)

# ç¤ºä¾‹3: ä»æŒ‡å®šæ—¶é—´æˆ³å¼€å§‹è·å–
import datetime
since = int(datetime.datetime(2024, 1, 1).timestamp() * 1000)
df = fetcher.fetch_ohlcv('ETH/USDT', '4h', 5000, since=since)

# ç¤ºä¾‹4: ç¦ç”¨ç¼“å­˜ï¼Œå¼ºåˆ¶ä»ç½‘ç»œè·å–
df = fetcher.fetch_ohlcv('BTC/USDT', '1h', 1000, use_cache=False)

# ç¤ºä¾‹5: ä½¿ç”¨ä»£ç†
proxy = {
    'http': 'http://127.0.0.1:7890',
    'https': 'http://127.0.0.1:7890'
}
fetcher = DataFetcher(exchange_name='okx', proxy=proxy)
df = fetcher.fetch_ohlcv('BTC/USDT', '1h', 1000)
```

##### 1.3.2 `fetch_ohlcv_by_date()` - æŒ‰æ—¥æœŸèŒƒå›´è·å–æ•°æ®

**åŠŸèƒ½ï¼š** æŒ‰æ—¥æœŸèŒƒå›´è·å–OHLCVæ•°æ®ï¼ˆæ›´ç›´è§‚çš„æ—¥æœŸæ¥å£ï¼‰

**å‚æ•°ï¼š**

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `symbol` | str | `'BTC/USDT'` | äº¤æ˜“å¯¹ |
| `timeframe` | str | `'1h'` | æ—¶é—´æ¡†æ¶ |
| `start_date` | str | `None` | èµ·å§‹æ—¥æœŸï¼Œæ ¼å¼ï¼š`'YYYY-MM-DD'` |
| `end_date` | str | `None` | ç»“æŸæ—¥æœŸï¼Œæ ¼å¼ï¼š`'YYYY-MM-DD'`ï¼Œé»˜è®¤ä¸ºå½“å‰æ—¶é—´ |

**è¿”å›å€¼ï¼š** `pd.DataFrame`ï¼ˆæ ¼å¼åŒ `fetch_ohlcv()`ï¼‰

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
# ç¤ºä¾‹1: è·å–2024å¹´1æœˆ1æ—¥åˆ°2024å¹´1æœˆ31æ—¥çš„æ•°æ®
df = fetcher.fetch_ohlcv_by_date(
    symbol='BTC/USDT',
    timeframe='1h',
    start_date='2024-01-01',
    end_date='2024-01-31'
)

# ç¤ºä¾‹2: è·å–ä»2024å¹´1æœˆ1æ—¥åˆ°ç°åœ¨çš„æ‰€æœ‰æ•°æ®
df = fetcher.fetch_ohlcv_by_date(
    symbol='ETH/USDT',
    timeframe='4h',
    start_date='2024-01-01'
)

# ç¤ºä¾‹3: è·å–æœ€è¿‘çš„æ•°æ®ï¼ˆä¸æŒ‡å®šæ—¥æœŸï¼‰
df = fetcher.fetch_ohlcv_by_date(
    symbol='BTC/USDT',
    timeframe='1d'
)
```

##### 1.3.3 `fetch_multiple_timeframes()` - è·å–å¤šæ—¶é—´æ¡†æ¶æ•°æ®

**åŠŸèƒ½ï¼š** ä¸€æ¬¡æ€§è·å–å¤šä¸ªæ—¶é—´æ¡†æ¶çš„æ•°æ®

**å‚æ•°ï¼š**

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `symbol` | str | `'BTC/USDT'` | äº¤æ˜“å¯¹ |
| `timeframes` | list | `['1h', '4h', '1d']` | æ—¶é—´æ¡†æ¶åˆ—è¡¨ |
| `limit` | int | `500` | æ¯ä¸ªæ—¶é—´æ¡†æ¶è·å–çš„Kçº¿æ•°é‡ |

**è¿”å›å€¼ï¼š** `Dict[str, pd.DataFrame]`ï¼Œé”®ä¸ºæ—¶é—´æ¡†æ¶ï¼Œå€¼ä¸ºå¯¹åº”çš„DataFrame

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
# è·å–å¤šä¸ªæ—¶é—´æ¡†æ¶çš„æ•°æ®
data = fetcher.fetch_multiple_timeframes(
    symbol='BTC/USDT',
    timeframes=['30m', '1h', '4h', '1d'],
    limit=1000
)

# è®¿é—®ä¸åŒæ—¶é—´æ¡†æ¶çš„æ•°æ®
df_30m = data['30m']
df_1h = data['1h']
df_4h = data['4h']
df_1d = data['1d']
```

##### 1.3.4 `get_available_symbols()` - è·å–å¯ç”¨äº¤æ˜“å¯¹

**åŠŸèƒ½ï¼š** è·å–äº¤æ˜“æ‰€æ‰€æœ‰å¯ç”¨çš„äº¤æ˜“å¯¹åˆ—è¡¨

**è¿”å›å€¼ï¼š** `list`ï¼Œäº¤æ˜“å¯¹å­—ç¬¦ä¸²åˆ—è¡¨

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
# è·å–æ‰€æœ‰å¯ç”¨äº¤æ˜“å¯¹
symbols = fetcher.get_available_symbols()
print(f"å…±æœ‰ {len(symbols)} ä¸ªäº¤æ˜“å¯¹")
print("å‰10ä¸ªäº¤æ˜“å¯¹:", symbols[:10])

# è¿‡æ»¤USDTäº¤æ˜“å¯¹
usdt_pairs = [s for s in symbols if s.endswith('/USDT')]
print(f"USDTäº¤æ˜“å¯¹æ•°é‡: {len(usdt_pairs)}")
```

#### 1.4 å‘åå…¼å®¹æ¥å£

##### `fetch_btc_ohlcv()` - ç®€åŒ–æ¥å£

**åŠŸèƒ½ï¼š** å¿«é€Ÿè·å–BTC/USDT 1å°æ—¶Kçº¿æ•°æ®ï¼ˆå‘åå…¼å®¹ï¼‰

**å‚æ•°ï¼š**

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `proxy` | Dict | `None` | ä»£ç†é…ç½® |
| `limit` | int | `500` | Kçº¿æ•°é‡ |

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
from data.fetch_data import fetch_btc_ohlcv

# å¿«é€Ÿè·å–BTCæ•°æ®
df = fetch_btc_ohlcv(limit=1000)

# ä½¿ç”¨ä»£ç†
proxy = {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
df = fetch_btc_ohlcv(proxy=proxy, limit=2000)
```

#### 1.5 ç¼“å­˜æœºåˆ¶è¯¦è§£

**ç¼“å­˜æ–‡ä»¶ç»“æ„ï¼š**
```
data/cache/
â”œâ”€â”€ okx_BTC_USDT_1h.parquet          # ç¼“å­˜æ•°æ®ï¼ˆParquetæ ¼å¼ï¼‰
â”œâ”€â”€ okx_BTC_USDT_1h_meta.json        # ç¼“å­˜å…ƒæ•°æ®
â”œâ”€â”€ okx_ETH_USDT_30m.parquet
â””â”€â”€ okx_ETH_USDT_30m_meta.json
```

**ç¼“å­˜å…ƒæ•°æ®æ ¼å¼ï¼š**
```json
{
    "symbol": "BTC/USDT",
    "timeframe": "1h",
    "last_update": "2024-01-15T10:30:00",
    "rows": 5000
}
```

**ç¼“å­˜ç­–ç•¥ï¼š**
1. æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨
2. æ£€æŸ¥ç¼“å­˜æ˜¯å¦è¿‡æœŸï¼ˆåŸºäº `cache_expiry_hours`ï¼‰
3. æ£€æŸ¥ç¼“å­˜æ•°æ®é‡æ˜¯å¦è¶³å¤Ÿ
4. å¦‚æœç¼“å­˜æœ‰æ•ˆï¼Œç›´æ¥è¿”å›ç¼“å­˜æ•°æ®
5. å¦‚æœç¼“å­˜æ— æ•ˆï¼Œä»ç½‘ç»œè·å–å¹¶æ›´æ–°ç¼“å­˜
6. ç½‘ç»œå¤±è´¥æ—¶ï¼Œå°è¯•ä½¿ç”¨è¿‡æœŸç¼“å­˜ï¼ˆé™çº§ç­–ç•¥ï¼‰

**ç¼“å­˜ç®¡ç†ï¼š**
```python
# ç¦ç”¨ç¼“å­˜
fetcher = DataFetcher(cache_enabled=False)

# è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ä¸º24å°æ—¶
fetcher = DataFetcher(cache_expiry_hours=24)

# è‡ªå®šä¹‰ç¼“å­˜ç›®å½•
fetcher = DataFetcher(cache_dir='my_custom_cache')
```

#### 1.6 é”™è¯¯å¤„ç†

**è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼š**
- ç½‘ç»œè¯·æ±‚å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•
- æ‰¹æ¬¡è·å–å¤±è´¥æ—¶è·³è¿‡è¯¥æ‰¹æ¬¡ç»§ç»­è·å–
- æœ€ç»ˆå¤±è´¥æ—¶å°è¯•ä½¿ç”¨è¿‡æœŸç¼“å­˜

**å¸¸è§é”™è¯¯å¤„ç†ï¼š**
```python
try:
    df = fetcher.fetch_ohlcv('BTC/USDT', '1h', 1000)
except Exception as e:
    print(f"æ•°æ®è·å–å¤±è´¥: {e}")
    # ç³»ç»Ÿä¼šè‡ªåŠ¨å°è¯•ä½¿ç”¨è¿‡æœŸç¼“å­˜
```

#### 1.7 æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å¯ç”¨ç¼“å­˜**ï¼šå¯¹äºé‡å¤è·å–çš„æ•°æ®ï¼Œç¼“å­˜å¯ä»¥å¤§å¹…æé«˜é€Ÿåº¦
2. **åˆç†è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´**ï¼šæ ¹æ®æ•°æ®æ›´æ–°é¢‘ç‡è®¾ç½®
3. **æ‰¹é‡è·å–**ï¼šä½¿ç”¨ `fetch_multiple_timeframes()` ä¸€æ¬¡æ€§è·å–å¤šä¸ªæ—¶é—´æ¡†æ¶
4. **ä½¿ç”¨ä»£ç†**ï¼šå¦‚æœç½‘ç»œä¸ç¨³å®šï¼Œé…ç½®ä»£ç†å¯ä»¥æé«˜æˆåŠŸç‡
5. **åˆ†æ‰¹è·å–å¤§é‡æ•°æ®**ï¼šç³»ç»Ÿè‡ªåŠ¨åˆ†æ‰¹ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†

#### 1.8 å®Œæ•´ä½¿ç”¨ç¤ºä¾‹

```python
from data.fetch_data import DataFetcher
from datetime import datetime

# 1. åˆ›å»ºæ•°æ®è·å–å™¨ï¼ˆå¸¦ä»£ç†ï¼‰
proxy = {
    'http': 'http://127.0.0.1:7890',
    'https': 'http://127.0.0.1:7890'
}
fetcher = DataFetcher(
    exchange_name='okx',
    proxy=proxy,
    cache_enabled=True,
    cache_expiry_hours=1
)

# 2. è·å–å•æ—¶é—´æ¡†æ¶æ•°æ®
df = fetcher.fetch_ohlcv('BTC/USDT', '30m', 20000)
print(f"æ•°æ®èŒƒå›´: {df.index[0]} ~ {df.index[-1]}")
print(f"æ•°æ®é‡: {len(df)} æ ¹Kçº¿")

# 3. æŒ‰æ—¥æœŸèŒƒå›´è·å–
df = fetcher.fetch_ohlcv_by_date(
    symbol='ETH/USDT',
    timeframe='4h',
    start_date='2024-01-01',
    end_date='2024-01-31'
)

# 4. è·å–å¤šæ—¶é—´æ¡†æ¶
multi_data = fetcher.fetch_multiple_timeframes(
    symbol='BTC/USDT',
    timeframes=['1h', '4h', '1d'],
    limit=1000
)

# 5. è·å–å¯ç”¨äº¤æ˜“å¯¹
symbols = fetcher.get_available_symbols()
print(f"å¯ç”¨äº¤æ˜“å¯¹æ•°é‡: {len(symbols)}")
```

### 2. ç­–ç•¥æ¨¡å—

#### 2.1 EMA+RSIç­–ç•¥ (`strategies/ema_rsi_strategy.py`)

**åŠŸèƒ½ï¼š**
- EMAå¤šå‘¨æœŸè¶‹åŠ¿åˆ¤æ–­
- RSIè¶…ä¹°è¶…å–ä¿¡å·
- ADXè¶‹åŠ¿å¼ºåº¦è¿‡æ»¤
- MACDç¡®è®¤ä¿¡å·
- ATRåŠ¨æ€æ­¢æŸæ­¢ç›ˆ
- ç§»åŠ¨æ­¢æŸä¿æŠ¤åˆ©æ¶¦
- æˆäº¤é‡è¿‡æ»¤

**å‚æ•°ï¼š**
- EMA: å¿«çº¿(12)ã€æ…¢çº¿(26)ã€è¶‹åŠ¿çº¿(55)
- RSI: å‘¨æœŸ14ï¼Œè¶…ä¹°70ï¼Œè¶…å–30
- ATR: æ­¢æŸ2.5å€ï¼Œæ­¢ç›ˆ3å€
- ADX: é˜ˆå€¼20

#### 2.2 å¢å¼ºç‰ˆç­–ç•¥ (`strategies/enhanced_ema_rsi_strategy.py`)

**æ–°å¢åŠŸèƒ½ï¼š**
- åŸºäºç›ˆåˆ©äº¤æ˜“åˆ†æçš„æœ€ä¼˜è¿‡æ»¤æ¡ä»¶
- é»‘å¤©é¹…äº‹ä»¶æ£€æµ‹å’Œé˜²æŠ¤
- åŠ¨æ€é£é™©è°ƒæ•´
- æ›´ä¸¥æ ¼çš„å…¥åœºæ¡ä»¶

### 3. å¤šå› å­ç³»ç»Ÿ (`factors/`)

#### 3.1 å› å­åº“ (`factors/factor_lib.py`)

**æ”¯æŒçš„å› å­ç±»å‹ï¼š**

**åŠ¨é‡å› å­ï¼š**
- æ”¶ç›Šç‡åŠ¨é‡ (MOM_5, MOM_10, MOM_20, MOM_60)
- åŠ¨é‡æ’å (MOM_RANK)
- å˜åŠ¨ç‡ (ROC)
- åŠ¨é‡åŠ é€Ÿåº¦ (ACCELERATION)

**æ³¢åŠ¨ç‡å› å­ï¼š**
- å†å²æ³¢åŠ¨ç‡ (VOL_10, VOL_20, VOL_60)
- æ³¢åŠ¨ç‡æ¯”ç‡ (VOL_RATIO)
- ATRç™¾åˆ†æ¯” (ATR_PCT)
- Parkinsonæ³¢åŠ¨ç‡ (PARKINSON_VOL)

**æˆäº¤é‡å› å­ï¼š**
- æˆäº¤é‡åŠ¨é‡ (VOL_MOM)
- ä»·é‡è¶‹åŠ¿ (PVT)
- OBVæ–œç‡ (OBV_SLOPE)
- VWAPåç¦» (VWAP_DEV)
- èµ„é‡‘æµé‡æŒ‡æ•° (MFI)

**è¶‹åŠ¿å› å­ï¼š**
- è¶‹åŠ¿å¼ºåº¦ (TREND_STRENGTH)
- EMAäº¤å‰å¼ºåº¦ (EMA_CROSS)
- ADXå› å­ (ADX_FACTOR)
- ä»·æ ¼é€šé“ä½ç½® (CHANNEL_POS)

**åè½¬å› å­ï¼š**
- RSIå› å­ (RSI_FACTOR)
- å¸ƒæ—å¸¦å› å­ (BB_FACTOR)
- å‡å€¼å›å½’ (MEAN_REV)
- éšæœºæŒ‡æ ‡ (STOCH_FACTOR)

**å¤åˆå› å­ï¼š**
- èªæ˜é’±å› å­ (SMART_MONEY)
- åŠ¨é‡è´¨é‡ (MOM_QUALITY)

#### 3.2 å› å­å¼•æ“ (`factors/factor_engine.py`)

**åŠŸèƒ½ï¼š**
- å› å­æ ‡å‡†åŒ–ï¼ˆZ-Scoreã€æ’åã€MinMaxï¼‰
- å› å­åˆæˆå’ŒåŠ æƒ
- å› å­ICåˆ†æ
- ä¿¡å·ç”Ÿæˆ

### 4. å›æµ‹å¼•æ“ (`backtester/backtest.py`)

**åŠŸèƒ½ï¼š**
- å®Œæ•´çš„äº¤æ˜“æ¨¡æ‹Ÿï¼ˆå¼€ä»“ã€å¹³ä»“ã€æ­¢æŸã€æ­¢ç›ˆï¼‰
- æ»‘ç‚¹å’Œæ‰‹ç»­è´¹æ¨¡æ‹Ÿ
- å®Œæ•´çš„ç»Ÿè®¡æŒ‡æ ‡è®¡ç®—

**ç»Ÿè®¡æŒ‡æ ‡ï¼š**
- åŸºç¡€ç»Ÿè®¡ï¼šæ€»æ”¶ç›Šã€æ”¶ç›Šç‡
- äº¤æ˜“ç»Ÿè®¡ï¼šäº¤æ˜“æ¬¡æ•°ã€èƒœç‡ã€ç›ˆäºæ¯”
- é£é™©æŒ‡æ ‡ï¼šæœ€å¤§å›æ’¤ã€å¤æ™®æ¯”ç‡ã€ç´¢æè¯ºæ¯”ç‡ã€å¡å°”é©¬æ¯”ç‡
- å¹´åŒ–æŒ‡æ ‡ï¼šå¹´åŒ–æ”¶ç›Šã€å¹´åŒ–æ³¢åŠ¨ç‡

### 5. ç›ˆåˆ©äº¤æ˜“åˆ†æ (`analysis/`)

#### 5.1 äº¤æ˜“åˆ†æå™¨ (`analysis/trade_analyzer.py`)

**åŠŸèƒ½ï¼š**
- åˆ†æç›ˆåˆ©äº¤æ˜“çš„å…±åŒç‰¹å¾
- å¯¹æ¯”ç›ˆåˆ©ä¸äºæŸäº¤æ˜“çš„å› å­å·®å¼‚
- æå–æœ€ä¼˜å› å­åŒºé—´
- ç”Ÿæˆè¯¦ç»†åˆ†ææŠ¥å‘Š

#### 5.2 åˆ†æè„šæœ¬ (`analysis/analyze_winning_trades.py`)

**åŠŸèƒ½ï¼š**
- ä¸€é”®åˆ†æç›ˆåˆ©äº¤æ˜“
- è‡ªåŠ¨æå–æœ€ä¼˜è¿‡æ»¤æ¡ä»¶
- ä¿å­˜åˆ†æç»“æœ

### 6. é£é™©ç®¡ç† (`risk/black_swan_protection.py`)

**åŠŸèƒ½ï¼š**
- æç«¯ä»·æ ¼æ³¢åŠ¨æ£€æµ‹ï¼ˆå•æ ¹Kçº¿>10%ï¼‰
- æ³¢åŠ¨ç‡å¼‚å¸¸æ£€æµ‹ï¼ˆZ-score>3ï¼‰
- æˆäº¤é‡å¼‚å¸¸æ£€æµ‹ï¼ˆ>5å€å¹³å‡ï¼‰
- è¿ç»­å¤§å¹…ä¸‹è·Œæ£€æµ‹
- æµåŠ¨æ€§å±æœºæ£€æµ‹
- åŠ¨æ€æ­¢æŸè°ƒæ•´
- ä»“ä½å¤§å°è°ƒæ•´
- äº¤æ˜“æš‚åœæœºåˆ¶

---

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

```bash
Python >= 3.8
```

### 2. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

ä¸»è¦ä¾èµ–ï¼š
- pandas
- numpy
- ccxt
- matplotlib
- pyarrow

### 3. åŸºæœ¬å›æµ‹

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®è¿è¡Œå›æµ‹
python main.py --mode backtest

# æŒ‡å®šäº¤æ˜“å¯¹å’Œæ—¶é—´æ¡†æ¶
python main.py --mode backtest --symbol BTC/USDT --timeframe 30m --limit 20000

# ä¸æ˜¾ç¤ºå›¾è¡¨
python main.py --mode backtest --no-chart
```

---

## è¯¦ç»†åŠŸèƒ½è¯´æ˜

### åŠŸèƒ½1: åŸºç¡€å›æµ‹

**ç”¨é€”ï¼š** ä½¿ç”¨EMA+RSIç­–ç•¥è¿›è¡Œå›æµ‹

**å‘½ä»¤ç¤ºä¾‹ï¼š**
```bash
# åŸºç¡€å›æµ‹ï¼ˆ30åˆ†é’ŸKçº¿ï¼Œ20000æ ¹ï¼‰
python main.py --mode backtest --symbol BTC/USDT --timeframe 30m --limit 20000

# å¿«é€Ÿå›æµ‹ï¼ˆ1å°æ—¶Kçº¿ï¼Œ1000æ ¹ï¼‰
python main.py --mode backtest --symbol BTC/USDT --timeframe 1h --limit 1000

# 4å°æ—¶Kçº¿å›æµ‹
python main.py --mode backtest --timeframe 4h --limit 2000

# ä¸æ˜¾ç¤ºå›¾è¡¨ï¼ˆåŠ å¿«é€Ÿåº¦ï¼‰
python main.py --mode backtest --symbol BTC/USDT --timeframe 1h --limit 1000 --no-chart
```

**è¾“å‡ºï¼š**
- å›æµ‹æŠ¥å‘Šï¼ˆæ”¶ç›Šã€èƒœç‡ã€æœ€å¤§å›æ’¤ç­‰ï¼‰
- äº¤æ˜“æ˜ç»†
- å¯è§†åŒ–å›¾è¡¨ï¼ˆä¿å­˜åœ¨ `logs/` ç›®å½•ï¼‰

### åŠŸèƒ½2: å¤šå› å­ç­–ç•¥å›æµ‹

**ç”¨é€”ï¼š** ä½¿ç”¨å¤šå› å­ç­–ç•¥è¿›è¡Œå›æµ‹

**å‘½ä»¤ç¤ºä¾‹ï¼š**
```bash
# å¤šå› å­ç­–ç•¥å›æµ‹ï¼ˆ4å°æ—¶Kçº¿ï¼Œ2000æ ¹ï¼‰
python main.py --mode factor --timeframe 4h --limit 2000

# æŒ‡å®šäº¤æ˜“å¯¹çš„å¤šå› å­å›æµ‹
python main.py --mode factor --symbol BTC/USDT --timeframe 30m --limit 20000

# ETH/USDT å¤šå› å­ç­–ç•¥
python main.py --mode factor --symbol ETH/USDT --timeframe 1h --limit 10000
```

**ç‰¹ç‚¹ï¼š**
- ç»¼åˆå¤šä¸ªå› å­ç”Ÿæˆä¿¡å·
- å› å­æ ‡å‡†åŒ–å’ŒåŠ æƒ
- æ›´æ™ºèƒ½çš„ä¿¡å·è¿‡æ»¤

### åŠŸèƒ½3: å› å­åˆ†æ

**ç”¨é€”ï¼š** åˆ†æå„ä¸ªå› å­çš„æœ‰æ•ˆæ€§ï¼ˆICã€ICIRç­‰ï¼‰ï¼ŒæŸ¥çœ‹å½“å‰å› å­çŠ¶æ€å’Œä¿¡å·

**å‘½ä»¤ç¤ºä¾‹ï¼š**
```bash
# å› å­åˆ†æï¼ˆ4å°æ—¶Kçº¿ï¼Œ1000æ ¹ï¼‰
python main.py --mode analysis --timeframe 4h --limit 1000

# è¯¦ç»†å› å­åˆ†æï¼ˆ30åˆ†é’ŸKçº¿ï¼Œ5000æ ¹ï¼‰
python main.py --mode analysis --symbol BTC/USDT --timeframe 30m --limit 5000

# æŒ‡å®šäº¤æ˜“å¯¹çš„å› å­åˆ†æ
python main.py --mode analysis --symbol ETH/USDT --timeframe 1h --limit 3000
```

**è¾“å‡ºï¼š**
- å› å­ICåˆ†ææŠ¥å‘Š
- å› å­æš´éœ²åº¦
- ç»¼åˆå› å­å¾—åˆ†
- äº¤æ˜“ä¿¡å·å»ºè®®

### åŠŸèƒ½4: å‚æ•°ä¼˜åŒ–

**ç”¨é€”ï¼š** è‡ªåŠ¨ä¼˜åŒ–ç­–ç•¥å‚æ•°ï¼ˆEMAã€RSIç­‰ï¼‰

**å‘½ä»¤ï¼š**
```bash
python main.py --mode optimize --symbol BTC/USDT --timeframe 30m --limit 5000
```

**è¾“å‡ºï¼š**
- æœ€ä¼˜å‚æ•°ç»„åˆ
- å¯¹åº”çš„å¤æ™®æ¯”ç‡ã€æ”¶ç›Šç‡ã€æœ€å¤§å›æ’¤

### åŠŸèƒ½5: ç›ˆåˆ©äº¤æ˜“åˆ†æ â­

**ç”¨é€”ï¼š** åˆ†æç›ˆåˆ©äº¤æ˜“ç‰¹å¾ï¼Œæå–æœ€ä¼˜è¿‡æ»¤æ¡ä»¶

**å‘½ä»¤ï¼š**
```bash
python analysis/analyze_winning_trades.py --symbol BTC/USDT --timeframe 30m --limit 20000
```

**è¾“å‡ºï¼š**
- ç›ˆåˆ©äº¤æ˜“ç‰¹å¾åˆ†ææŠ¥å‘Š
- æœ€ä¼˜å› å­åŒºé—´
- åˆ†æç»“æœJSONæ–‡ä»¶ï¼ˆä¿å­˜åœ¨ `analysis/results/`ï¼‰

**ä½¿ç”¨åœºæ™¯ï¼š**
1. å›æµ‹åå‘ç°èƒœç‡è¾ƒä½
2. æƒ³è¦ä¼˜åŒ–ç­–ç•¥è¿‡æ»¤æ¡ä»¶
3. äº†è§£ç›ˆåˆ©äº¤æ˜“çš„ç‰¹å¾

### åŠŸèƒ½6: å¢å¼ºç‰ˆç­–ç•¥å›æµ‹

**ç”¨é€”ï¼š** ä½¿ç”¨åŸºäºç›ˆåˆ©äº¤æ˜“åˆ†æä¼˜åŒ–çš„ç­–ç•¥

**å‘½ä»¤ï¼š**
```bash
python example_enhanced_strategy.py
```

**ç‰¹ç‚¹ï¼š**
- æ•´åˆæœ€ä¼˜è¿‡æ»¤æ¡ä»¶
- é»‘å¤©é¹…äº‹ä»¶é˜²æŠ¤
- åŠ¨æ€é£é™©è°ƒæ•´

---

## å‘½ä»¤è¡Œä½¿ç”¨

### ä¸»ç¨‹åº (`main.py`)

#### åŸºæœ¬è¯­æ³•

```bash
python main.py [é€‰é¡¹]
```

#### å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ | ç¤ºä¾‹ |
|------|------|--------|------|
| `--mode` | è¿è¡Œæ¨¡å¼ | `backtest` | `backtest`, `factor`, `optimize`, `analysis` |
| `--symbol` | äº¤æ˜“å¯¹ | `BTC/USDT` | `ETH/USDT`, `BTC/USDT` |
| `--timeframe` | æ—¶é—´æ¡†æ¶ | `1h` | `30m`, `1h`, `4h`, `1d` |
| `--limit` | Kçº¿æ•°é‡ | `1000` | `5000`, `20000` |
| `--capital` | åˆå§‹èµ„é‡‘ | ä½¿ç”¨é…ç½®æ–‡ä»¶ | `10000` |
| `--no-chart` | ä¸æ˜¾ç¤ºå›¾è¡¨ | `False` | - |
| `--no-proxy` | ç¦ç”¨ä»£ç† | `False` | - |

#### ä½¿ç”¨ç¤ºä¾‹

**åŸºç¡€å›æµ‹ï¼ˆEMA+RSIç­–ç•¥ï¼‰ï¼š**

```bash
# 1. é»˜è®¤é…ç½®å›æµ‹
python main.py --mode backtest

# 2. æŒ‡å®šäº¤æ˜“å¯¹å’Œæ—¶é—´æ¡†æ¶
python main.py --mode backtest --symbol BTC/USDT --timeframe 1h --limit 1000

# 3. 30åˆ†é’ŸKçº¿ï¼Œ20000æ ¹ï¼ˆæ¨èç”¨äºè¯¦ç»†åˆ†æï¼‰
python main.py --mode backtest --symbol BTC/USDT --timeframe 30m --limit 20000

# 4. 4å°æ—¶Kçº¿ï¼Œ2000æ ¹
python main.py --mode backtest --timeframe 4h --limit 2000

# 5. ETH/USDT 1å°æ—¶Kçº¿
python main.py --mode backtest --symbol ETH/USDT --timeframe 1h --limit 5000
```

**å¤šå› å­ç­–ç•¥å›æµ‹ï¼š**

```bash
# 1. å¤šå› å­ç­–ç•¥å›æµ‹ï¼ˆ4å°æ—¶Kçº¿ï¼Œ2000æ ¹ï¼‰
python main.py --mode factor --timeframe 4h --limit 2000

# 2. æŒ‡å®šäº¤æ˜“å¯¹çš„å¤šå› å­å›æµ‹
python main.py --mode factor --symbol BTC/USDT --timeframe 1h --limit 10000

# 3. ETH/USDT å¤šå› å­ç­–ç•¥
python main.py --mode factor --symbol ETH/USDT --timeframe 30m --limit 5000
```

**å› å­åˆ†æï¼š**

```bash
# 1. å› å­åˆ†æ - æŸ¥çœ‹å½“å‰å› å­çŠ¶æ€å’Œä¿¡å·ï¼ˆ4å°æ—¶Kçº¿ï¼Œ1000æ ¹ï¼‰
python main.py --mode analysis --timeframe 4h --limit 1000

# 2. æŒ‡å®šäº¤æ˜“å¯¹çš„å› å­åˆ†æ
python main.py --mode analysis --symbol BTC/USDT --timeframe 1h --limit 5000

# 3. è¯¦ç»†å› å­åˆ†æï¼ˆæ›´å¤šæ•°æ®ï¼‰
python main.py --mode analysis --symbol BTC/USDT --timeframe 30m --limit 10000
```

**å‚æ•°ä¼˜åŒ–ï¼š**

```bash
# 1. ä¼˜åŒ–ç­–ç•¥å‚æ•°
python main.py --mode optimize --symbol BTC/USDT --timeframe 1h --limit 5000

# 2. 4å°æ—¶Kçº¿å‚æ•°ä¼˜åŒ–
python main.py --mode optimize --timeframe 4h --limit 3000
```

**å…¶ä»–é€‰é¡¹ï¼š**

```bash
# 1. ä¸æ˜¾ç¤ºå›¾è¡¨ï¼ˆåŠ å¿«è¿è¡Œé€Ÿåº¦ï¼‰
python main.py --mode backtest --no-chart

# 2. ç¦ç”¨ä»£ç†
python main.py --mode backtest --no-proxy

# 3. æŒ‡å®šåˆå§‹èµ„é‡‘
python main.py --mode backtest --capital 10000 --symbol BTC/USDT --timeframe 1h --limit 1000

# 4. ç»„åˆä½¿ç”¨ï¼šä¸æ˜¾ç¤ºå›¾è¡¨ + ç¦ç”¨ä»£ç†
python main.py --mode backtest --no-chart --no-proxy --symbol BTC/USDT --timeframe 1h --limit 1000
```

**å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥ï¼š**

```bash
# å¿«é€Ÿå›æµ‹ï¼ˆ1å°æ—¶Kçº¿ï¼Œ1000æ ¹ï¼‰
python main.py --symbol BTC/USDT --timeframe 1h --limit 1000

# å› å­åˆ†æï¼ˆ4å°æ—¶Kçº¿ï¼‰
python main.py --mode analysis --timeframe 4h --limit 1000

# å› å­ç­–ç•¥å›æµ‹ï¼ˆ4å°æ—¶Kçº¿ï¼‰
python main.py --mode factor --timeframe 4h --limit 2000

# ä¼ ç»ŸEMAç­–ç•¥å›æµ‹ï¼ˆ4å°æ—¶Kçº¿ï¼‰
python main.py --mode backtest --timeframe 4h --limit 2000
```

### ç›ˆåˆ©äº¤æ˜“åˆ†æ (`analysis/analyze_winning_trades.py`)

#### åŸºæœ¬è¯­æ³•

```bash
python analysis/analyze_winning_trades.py [é€‰é¡¹]
```

#### å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--symbol` | äº¤æ˜“å¯¹ | `BTC/USDT` |
| `--timeframe` | æ—¶é—´æ¡†æ¶ | `30m` |
| `--limit` | Kçº¿æ•°é‡ | `20000` |

#### ä½¿ç”¨ç¤ºä¾‹

```bash
# åˆ†æBTC/USDT 30åˆ†é’ŸKçº¿çš„ç›ˆåˆ©äº¤æ˜“
python analysis/analyze_winning_trades.py --symbol BTC/USDT --timeframe 30m --limit 20000

# åˆ†æETH/USDT 1å°æ—¶Kçº¿
python analysis/analyze_winning_trades.py --symbol ETH/USDT --timeframe 1h --limit 15000
```

---

## Python APIä½¿ç”¨

### 1. åŸºç¡€å›æµ‹

```python
from config.settings import default_config
from data.fetch_data import DataFetcher
from strategies.ema_rsi_strategy import EmaRsiStrategy
from backtester.backtest import Backtester

# è·å–æ•°æ®
fetcher = DataFetcher(exchange_name='okx', cache_enabled=True)
df = fetcher.fetch_ohlcv('BTC/USDT', '30m', 20000)

# åˆå§‹åŒ–ç­–ç•¥
strategy = EmaRsiStrategy(risk_per_trade=0.02)
df = strategy.generate_signals(df)

# è¿è¡Œå›æµ‹
backtester = Backtester(initial_capital=1000, fee_rate=0.001)
df, result = backtester.run(df)

# æ‰“å°æŠ¥å‘Š
backtester.print_report(result)
```

### 2. å¤šå› å­ç­–ç•¥

```python
from factors.factor_engine import FactorStrategy

# åˆ›å»ºå¤šå› å­ç­–ç•¥
strategy = FactorStrategy(
    lookback_period=100,
    signal_threshold=0.25,
    min_holding_period=12,
    stop_loss_atr=2.0,
    take_profit_atr=4.0
)

df = strategy.generate_signals(df)
```

### 3. ç›ˆåˆ©äº¤æ˜“åˆ†æ

```python
from analysis.trade_analyzer import TradeAnalyzer
from backtester.backtest import Backtester

# è¿è¡Œå›æµ‹è·å–äº¤æ˜“è®°å½•
backtester = Backtester(initial_capital=1000)
df, result = backtester.run(df)

# åˆ†æç›ˆåˆ©äº¤æ˜“
analyzer = TradeAnalyzer()
analysis = analyzer.analyze_trades(result.trades, df)

# æ‰“å°åˆ†ææŠ¥å‘Š
analyzer.print_analysis_report(analysis)

# æå–æœ€ä¼˜è¿‡æ»¤æ¡ä»¶
optimal_filters = analyzer.extract_optimal_filters(analysis)
```

### 4. å¢å¼ºç‰ˆç­–ç•¥

```python
from strategies.enhanced_ema_rsi_strategy import EnhancedEmaRsiStrategy

# åŠ è½½æœ€ä¼˜è¿‡æ»¤æ¡ä»¶ï¼ˆä»åˆ†æç»“æœä¸­è·å–ï¼‰
optimal_filters = {
    'RSI': {'min': 40, 'max': 65, 'mean': 52},
    'ADX': {'min': 25, 'max': 45, 'mean': 35},
    'VOLUME_RATIO': {'min': 1.0, 'max': 2.5, 'mean': 1.5},
    # ... å…¶ä»–è¿‡æ»¤æ¡ä»¶
}

# åˆ›å»ºå¢å¼ºç‰ˆç­–ç•¥
strategy = EnhancedEmaRsiStrategy(
    optimal_filters=optimal_filters,
    enable_black_swan_protection=True
)

df = strategy.generate_signals(df)
```

### 5. å› å­åˆ†æ

```python
from factors.factor_lib import FactorCalculator
from factors.factor_engine import FactorEngine

# è®¡ç®—å› å­
calc = FactorCalculator(df)
factors = calc.calculate_all()

# å› å­åˆ†æ
engine = FactorEngine()
future_returns = df['close'].pct_change(10).shift(-10)
analysis = engine.factor_analysis(factors, future_returns)

# æ‰“å°æŠ¥å‘Š
engine.print_factor_report(analysis)
```

---

## é…ç½®æ–‡ä»¶è¯´æ˜

é…ç½®æ–‡ä»¶ä½äº `config/settings.py`ï¼Œä¸»è¦é…ç½®é¡¹ï¼š

### æ•°æ®é…ç½®

```python
data = DataConfig(
    symbol="BTC/USDT",      # äº¤æ˜“å¯¹
    timeframe="1h",         # æ—¶é—´æ¡†æ¶
    limit=1000,             # Kçº¿æ•°é‡
    cache_enabled=True,     # å¯ç”¨ç¼“å­˜
    cache_dir="data/cache"  # ç¼“å­˜ç›®å½•
)
```

### ç­–ç•¥é…ç½®

```python
strategy = StrategyConfig(
    risk_per_trade=0.02,           # æ¯ç¬”äº¤æ˜“é£é™©æ¯”ä¾‹ï¼ˆ2%ï¼‰
    use_volume_filter=True,        # ä½¿ç”¨æˆäº¤é‡è¿‡æ»¤
    min_signal_strength=0.2       # æœ€å°ä¿¡å·å¼ºåº¦
)
```

### å›æµ‹é…ç½®

```python
backtest = BacktestConfig(
    initial_capital=1000,    # åˆå§‹èµ„é‡‘
    fee_rate=0.001,          # æ‰‹ç»­è´¹ç‡ï¼ˆ0.1%ï¼‰
    slippage=0.0005,        # æ»‘ç‚¹ï¼ˆ0.05%ï¼‰
    use_stop_loss=True,      # ä½¿ç”¨æ­¢æŸ
    use_take_profit=True     # ä½¿ç”¨æ­¢ç›ˆ
)
```

### ä»£ç†é…ç½®

```python
proxy = ProxyConfig(
    enabled=True,                    # å¯ç”¨ä»£ç†
    http="http://127.0.0.1:7890",  # HTTPä»£ç†
    https="http://127.0.0.1:7890"   # HTTPSä»£ç†
)
```

---

## å·¥ä½œæµç¨‹å»ºè®®

### åœºæ™¯1: æ–°ç­–ç•¥å¼€å‘

1. **è·å–æ•°æ®**
   ```bash
   python main.py --mode backtest --symbol BTC/USDT --timeframe 30m --limit 20000
   ```

2. **åˆ†æç»“æœ**
   - æŸ¥çœ‹å›æµ‹æŠ¥å‘Š
   - æ£€æŸ¥èƒœç‡ã€ç›ˆäºæ¯”ã€æœ€å¤§å›æ’¤

3. **ä¼˜åŒ–ç­–ç•¥**
   ```bash
   # åˆ†æç›ˆåˆ©äº¤æ˜“
   python analysis/analyze_winning_trades.py --symbol BTC/USDT --timeframe 30m --limit 20000
   
   # ä½¿ç”¨å¢å¼ºç‰ˆç­–ç•¥
   python example_enhanced_strategy.py
   ```

### åœºæ™¯2: å› å­ç ”ç©¶

1. **å› å­åˆ†æ**
   ```bash
   python main.py --mode analysis --symbol BTC/USDT --timeframe 1h --limit 5000
   ```

2. **æŸ¥çœ‹å› å­IC**
   - å…³æ³¨ICIRé«˜çš„å› å­
   - æ£€æŸ¥å› å­æš´éœ²åº¦

3. **å¤šå› å­ç­–ç•¥å›æµ‹**
   ```bash
   python main.py --mode factor --symbol BTC/USDT --timeframe 1h --limit 10000
   ```

### åœºæ™¯3: å‚æ•°ä¼˜åŒ–

1. **è¿è¡Œä¼˜åŒ–**
   ```bash
   python main.py --mode optimize --symbol BTC/USDT --timeframe 1h --limit 5000
   ```

2. **åº”ç”¨æœ€ä¼˜å‚æ•°**
   - ä¿®æ”¹ç­–ç•¥å‚æ•°
   - é‡æ–°å›æµ‹éªŒè¯

### åœºæ™¯4: ç­–ç•¥æ”¹è¿›ï¼ˆæ¨èæµç¨‹ï¼‰

1. **åˆå§‹å›æµ‹**
   ```bash
   python main.py --mode backtest --symbol BTC/USDT --timeframe 30m --limit 20000
   ```

2. **åˆ†æç›ˆåˆ©äº¤æ˜“**
   ```bash
   python analysis/analyze_winning_trades.py --symbol BTC/USDT --timeframe 30m --limit 20000
   ```

3. **æå–æœ€ä¼˜è¿‡æ»¤æ¡ä»¶**
   - æŸ¥çœ‹åˆ†ææŠ¥å‘Šä¸­çš„æœ€ä¼˜å› å­åŒºé—´
   - è®°å½•åˆ°é…ç½®ä¸­

4. **ä½¿ç”¨å¢å¼ºç‰ˆç­–ç•¥**
   ```bash
   python example_enhanced_strategy.py
   ```

5. **å¯¹æ¯”ç»“æœ**
   - å¯¹æ¯”æ”¹è¿›å‰åçš„å›æµ‹ç»“æœ
   - éªŒè¯æ”¹è¿›æ•ˆæœ

---

## è¾“å‡ºæ–‡ä»¶è¯´æ˜

### å›æµ‹å›¾è¡¨

ä½ç½®ï¼š`logs/backtest_YYYYMMDD_HHMMSS.png`

åŒ…å«ï¼š
- ä»·æ ¼å’Œä¿¡å·å›¾
- æƒç›Šæ›²çº¿
- å›æ’¤æ›²çº¿
- æŠ€æœ¯æŒ‡æ ‡å›¾

### åˆ†æç»“æœ

ä½ç½®ï¼š`analysis/results/winning_trades_analysis_YYYYMMDD_HHMMSS.json`

åŒ…å«ï¼š
- å› å­å·®å¼‚åˆ†æ
- æœ€ä¼˜è¿‡æ»¤æ¡ä»¶
- å›æµ‹æ‘˜è¦

### æ•°æ®ç¼“å­˜

ä½ç½®ï¼š`data/cache/`

æ ¼å¼ï¼šParquetæ–‡ä»¶
- æé«˜æ•°æ®åŠ è½½é€Ÿåº¦
- å‡å°‘APIè¯·æ±‚

---

## å¸¸è§é—®é¢˜

### Q1: æ•°æ®è·å–å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A:** 
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ£€æŸ¥ä»£ç†è®¾ç½®ï¼ˆ`config/settings.py`ï¼‰
3. ä½¿ç”¨ `--no-proxy` ç¦ç”¨ä»£ç†
4. æ£€æŸ¥äº¤æ˜“æ‰€APIé™åˆ¶

### Q2: å¦‚ä½•ä¿®æ”¹ç­–ç•¥å‚æ•°ï¼Ÿ

**A:**
1. ç›´æ¥ä¿®æ”¹ç­–ç•¥ç±»å‚æ•°
2. æˆ–åœ¨åˆ›å»ºç­–ç•¥å®ä¾‹æ—¶ä¼ å…¥å‚æ•°ï¼š
   ```python
   strategy = EmaRsiStrategy(
       ema_fast=15,
       ema_slow=30,
       rsi_period=14
   )
   ```

### Q3: å¦‚ä½•æ·»åŠ æ–°çš„å› å­ï¼Ÿ

**A:**
1. åœ¨ `factors/factor_lib.py` çš„ `FactorCalculator` ç±»ä¸­æ·»åŠ æ–¹æ³•
2. åœ¨ `calculate_all()` ä¸­è°ƒç”¨æ–°å› å­
3. åœ¨ `factors/factor_engine.py` ä¸­æ·»åŠ æƒé‡é…ç½®

### Q4: å¦‚ä½•è‡ªå®šä¹‰å›æµ‹å‚æ•°ï¼Ÿ

**A:**
```python
backtester = Backtester(
    initial_capital=10000,  # åˆå§‹èµ„é‡‘
    fee_rate=0.001,        # æ‰‹ç»­è´¹
    slippage=0.0005,      # æ»‘ç‚¹
    use_stop_loss=True,    # æ­¢æŸ
    use_take_profit=True   # æ­¢ç›ˆ
)
```

### Q5: ç›ˆåˆ©äº¤æ˜“åˆ†æç»“æœå¦‚ä½•ä½¿ç”¨ï¼Ÿ

**A:**
1. è¿è¡Œåˆ†æè„šæœ¬è·å–æœ€ä¼˜è¿‡æ»¤æ¡ä»¶
2. å°†è¿‡æ»¤æ¡ä»¶ä¼ é€’ç»™å¢å¼ºç‰ˆç­–ç•¥ï¼š
   ```python
   strategy = EnhancedEmaRsiStrategy(
       optimal_filters=optimal_filters  # ä»åˆ†æç»“æœä¸­è·å–
   )
   ```

### Q6: é»‘å¤©é¹…é˜²æŠ¤å¦‚ä½•å·¥ä½œï¼Ÿ

**A:**
- è‡ªåŠ¨æ£€æµ‹æç«¯å¸‚åœºäº‹ä»¶
- æ£€æµ‹åˆ°é«˜é£é™©æ—¶ï¼š
  - æ”¶ç´§æ­¢æŸ
  - å‡å°‘ä»“ä½
  - æš‚åœå¼€æ–°ä»“
- å¯åœ¨ç­–ç•¥ä¸­å¯ç”¨/ç¦ç”¨

### Q7: å¦‚ä½•æé«˜å›æµ‹é€Ÿåº¦ï¼Ÿ

**A:**
1. å¯ç”¨æ•°æ®ç¼“å­˜ï¼ˆé»˜è®¤å·²å¯ç”¨ï¼‰
2. å‡å°‘Kçº¿æ•°é‡
3. ä½¿ç”¨ `--no-chart` ä¸ç”Ÿæˆå›¾è¡¨

### Q8: å›æµ‹ç»“æœä¸ç†æƒ³æ€ä¹ˆåŠï¼Ÿ

**A:**
1. è¿è¡Œç›ˆåˆ©äº¤æ˜“åˆ†æï¼Œäº†è§£ç›ˆåˆ©äº¤æ˜“ç‰¹å¾
2. ä½¿ç”¨å¢å¼ºç‰ˆç­–ç•¥ï¼Œåº”ç”¨æœ€ä¼˜è¿‡æ»¤æ¡ä»¶
3. è°ƒæ•´ç­–ç•¥å‚æ•°
4. å°è¯•ä¸åŒçš„æ—¶é—´æ¡†æ¶

---

## ç³»ç»Ÿæ¶æ„

```
crypto_quant/
â”œâ”€â”€ main.py                    # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ config/                    # é…ç½®æ¨¡å—
â”‚   â””â”€â”€ settings.py
â”œâ”€â”€ data/                      # æ•°æ®æ¨¡å—
â”‚   â””â”€â”€ fetch_data.py
â”œâ”€â”€ strategies/                # ç­–ç•¥æ¨¡å—
â”‚   â”œâ”€â”€ ema_rsi_strategy.py
â”‚   â””â”€â”€ enhanced_ema_rsi_strategy.py
â”œâ”€â”€ factors/                   # å› å­æ¨¡å—
â”‚   â”œâ”€â”€ factor_lib.py
â”‚   â””â”€â”€ factor_engine.py
â”œâ”€â”€ backtester/                # å›æµ‹æ¨¡å—
â”‚   â””â”€â”€ backtest.py
â”œâ”€â”€ analysis/                  # åˆ†ææ¨¡å—
â”‚   â”œâ”€â”€ trade_analyzer.py
â”‚   â””â”€â”€ analyze_winning_trades.py
â”œâ”€â”€ risk/                      # é£é™©ç®¡ç†æ¨¡å—
â”‚   â””â”€â”€ black_swan_protection.py
â”œâ”€â”€ logs/                      # æ—¥å¿—å’Œå›¾è¡¨
â””â”€â”€ data/cache/                # æ•°æ®ç¼“å­˜
```

---

## æ›´æ–°æ—¥å¿—

### v3.0 (å½“å‰ç‰ˆæœ¬)
- âœ… æ·»åŠ ç›ˆåˆ©äº¤æ˜“åˆ†æåŠŸèƒ½
- âœ… æ·»åŠ é»‘å¤©é¹…äº‹ä»¶é˜²æŠ¤
- âœ… å¢å¼ºç‰ˆç­–ç•¥ï¼ˆåŸºäºåˆ†æç»“æœä¼˜åŒ–ï¼‰
- âœ… å¤šå› å­ç­–ç•¥ç³»ç»Ÿ
- âœ… å®Œæ•´çš„å› å­åº“

### v2.2
- EMA+RSIç­–ç•¥
- åŸºç¡€å›æµ‹åŠŸèƒ½
- æ•°æ®è·å–å’Œç¼“å­˜

---

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
2. ä¾èµ–æ˜¯å¦å®Œæ•´å®‰è£…
3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
4. æ•°æ®æ˜¯å¦æˆåŠŸè·å–

---

**ç¥äº¤æ˜“é¡ºåˆ©ï¼** ğŸ“ˆ

